# ADR-004: Self-Review Mechanism in PlannerAgent

**Status:** accepted
**Date:** 2026-02-26

## Context

The PlannerAgent occasionally generated execution plans that overlooked specific user constraints or edge cases, leading to downstream execution failures or misalignment with user intent.

## Decision

Implemented a mandatory self-review step within the PlannerAgent's internal logic. This involves updating the `ExecutionPlan` schema to include a `self_review_notes` field and modifying the system prompt to require the LLM to explicitly verify the plan against provided constraints before finalizing the output.

## Consequences

Increased reliability of generated plans and better alignment with complex constraints. There is a marginal increase in token usage and latency due to the additional reasoning required in the response.

## Alternatives Considered

- External Validator Agent (rejected due to increased latency/cost)
- Hardcoded rule-based validation (rejected due to lack of flexibility with natural language constraints)

---
*Generated by GLITCHLAB / Archivist Nova*
